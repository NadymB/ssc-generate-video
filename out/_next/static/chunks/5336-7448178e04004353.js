(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5336],{49643:function(){},243:function(){},75551:function(e,a,t){"use strict";t.d(a,{tH:function(){return createTeamApi},MM:function(){return deleteTeamApi},Cl:function(){return fetchDetailTeamApi},CB:function(){return fetchListTeamApi},eQ:function(){return updateTeamApi}});let n="api/v1/teams";var i=t(96657);let l=new i.Z({url:"https://mhtai.kenroly.com"});l.createEntities([{name:n}]);let fetchListTeamApi=e=>l.createBasicCRUDEndpoints({name:n}).get(e),createTeamApi=e=>l.createBasicCRUDEndpoints({name:"api/v1/teams"}).post(e),updateTeamApi=e=>l.createBasicCRUDEndpoints({name:"api/v1/teams"}).put(e),fetchDetailTeamApi=e=>l.createBasicCRUDEndpoints({name:"api/v1/teams"}).getOne(e),deleteTeamApi=e=>l.createBasicCRUDEndpoints({name:"api/v1/teams"}).delete(e)},77032:function(e,a,t){"use strict";t.d(a,{F8:function(){return createNewUserApi},L2:function(){return fetchListUserApi}});let n="api/v1/users";var i=t(96657);let l=new i.Z({url:"https://mhtai.kenroly.com"});l.createEntities([{name:n},{name:"api/v1/groups"}]);let fetchListUserApi=e=>l.createBasicCRUDEndpoints({name:n}).get(e),createNewUserApi=e=>l.createBasicCRUDEndpoints({name:"api/v1/users"}).post(e)},38661:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return TeamManagement}});var n=t(57437),i=t(2265),l=t(20020),s=t(18142),r=t(68939),d=t(65473),o=t(88110),u=t.n(o),c=t(33071),m=t(53648),v=t(59611),p=t(14472),h=t(44511);t(71727);var f=t(75551),x=t(77032);t(50088);var g=t(92237);t(97212);var T=t(5925);function TeamManagement(){var e,a,t,o;let[b,C]=(0,i.useState)({}),[j,A]=(0,i.useState)([]),[w,y]=(0,i.useState)([]),[S,_]=(0,i.useState)([]),[E,N]=(0,i.useState)(""),[L,M]=(0,i.useState)({page:1,pageSize:10,meta:null}),[R,U]=(0,i.useState)(!1),[Z,k]=(0,i.useState)(!1),D=(0,i.useRef)(),B=(0,i.useRef)();(0,i.useRef)();let[q,z]=(0,i.useState)(!1),handleDeleteTeam=async()=>{console.log("deleteTeamId:",E);try{let e=await (0,f.MM)(E);(null==e?void 0:e.status)===200&&T.Am.success("X\xf3a team th\xe0nh c\xf4ng!")}catch(i){var e,a,t,n;console.error("An error occurred when update team:",null==i?void 0:null===(a=i.response)||void 0===a?void 0:null===(e=a.data)||void 0===e?void 0:e.message),T.Am.error(null==i?void 0:null===(n=i.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message)}z(!1),N("")},[F,O]=i.useState(null);(0,i.useEffect)(()=>{console.log("detailTeam:",b)},[b]);let handleUpdateTeam=async e=>{var a,t,n,i,l;try{let t="name_"+(null==b?void 0:b.id),n={id:null==b?void 0:b.id,name:e[t],...e},i=await (0,f.eQ)(n);(null==i?void 0:i.status)===200&&(T.Am.success("Cập nhật team th\xe0nh c\xf4ng!"),fetchTeamList(1,L.pageSize),null===(a=B.current)||void 0===a||a.resetFields(),k(!1))}catch(e){console.error("An error occurred when update team:",null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message),T.Am.error(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)}},handleCreateTeam=async e=>{var a,t,n,i,l;try{let t=await (0,f.tH)(e);(null==t?void 0:t.status)===200&&(T.Am.success("Create a new team successfully!"),fetchTeamList(1,L.pageSize),null===(a=D.current)||void 0===a||a.resetFields(),U(!1))}catch(e){console.error("An error occurred:",null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message),T.Am.error(null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)}},fetchManagerList=async e=>{try{var a,t;let n=await (0,x.L2)({group_name:e});A(null==n?void 0:null===(t=n.data)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.items)}catch(e){console.error("fetch manager list failed:",e)}},fetchSupervisorList=async e=>{try{var a,t;let n=await (0,x.L2)({group_name:e});y(null==n?void 0:null===(t=n.data)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.items)}catch(e){console.error("fetch supervisor list failed:",e)}},fetchTeamList=async(e,a)=>{try{var t,n,i,l;let s=await (0,f.CB)({page:e,limit:a}),r=null==s?void 0:null===(n=s.data)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.meta;M(e=>({...e,meta:r})),_(null==s?void 0:null===(l=s.data)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.items)}catch(e){console.error("fetch user list failed:",e)}};(0,i.useEffect)(()=>{fetchTeamList(L.page,L.pageSize)},[L.page]),(0,i.useEffect)(()=>{fetchManagerList("MANAGER")},[]),(0,i.useEffect)(()=>{fetchSupervisorList("SUPERVISOR")},[]);let $={required:"${label} is required!",types:{email:"${label} is not a valid email!",number:"${label} is not a valid number!"},number:{range:"${label} must be between ${min} and ${max}"}};return(0,i.useEffect)(()=>{console.log("detailTeam:",b)},[b]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"techwave_fn_community_page",children:[(0,n.jsx)("div",{className:"fn__title_holder",children:(0,n.jsx)("div",{className:"container-fluid",children:(0,n.jsx)("h1",{className:"title",children:"Team Management"})})}),(0,n.jsx)("div",{className:"techwave_fn_feed",children:(0,n.jsxs)("div",{className:"container-fluid",children:[(0,n.jsx)("div",{className:"w-100 d-flex justify-content-end",children:(0,n.jsx)(u(),{type:"primary",size:"large",icon:(0,n.jsx)(g.Z,{}),className:"d-flex align-items-center bg-success",onClick:()=>{U(!0)},children:"Create a new team"})}),(0,n.jsx)(r.Z,{columns:[{title:"Name",dataIndex:"name",key:"name",render:e=>(0,n.jsx)("span",{children:e})},{title:"Manager",dataIndex:"manager",key:"manager",render:(e,a)=>{let{manager:t}=a;return null==t?void 0:t.name}},{title:"Supervisor",dataIndex:"supervisor",key:"supervisor",render:(e,a)=>{let{supervisor:t}=a;return null==t?void 0:t.name}}],dataSource:S,pagination:!1,className:"mt-2"}),";",(0,n.jsx)(l.Z,{children:(0,n.jsx)(s.Z,{xs:24,children:(0,n.jsx)("div",{className:"user-card-pagination text-end mt-5",children:(0,n.jsx)(d.default,{align:"end",total:null==L?void 0:null===(e=L.meta)||void 0===e?void 0:e.total,onChange:e=>{M(a=>({...a,page:e}))},current:L.page,pageSize:L.pageSize})})})})]})})]}),(0,n.jsxs)(m.Y,{title:"Tạo mới team",open:R,onFinish:handleCreateTeam,onOpenChange:U,submitter:{searchConfig:{submitText:"Submit",resetText:"Close"}},validateMessages:$,formRef:D,children:[(0,n.jsx)(v.A.Group,{children:(0,n.jsx)(p.Z,{width:"md",name:"name",label:"T\xean của Team",tooltip:"Nhập t\xean của team",placeholder:"Nhập t\xean của team",rules:[{required:!0}]})}),(0,n.jsxs)(v.A.Group,{children:[(0,n.jsx)(h.Z,{options:null==j?void 0:j.map(e=>({value:e.id,label:e.name})),width:"md",placeholder:"...",name:"manager_id",label:"Chọn Manager",rules:[{required:!0}]}),(0,n.jsx)(h.Z,{options:null==w?void 0:w.map(e=>({value:e.id,label:e.name})),width:"md",placeholder:"...",name:"supervisor_id",label:"Chọn Supervisor",rules:[{required:!0}]})]})]}),(0,n.jsxs)(m.Y,{title:"Cập nhật team",open:Z,onFinish:handleUpdateTeam,onOpenChange:k,submitter:{searchConfig:{submitText:"Submit",resetText:"Close"}},validateMessages:$,formRef:B,modalProps:{destroyOnClose:!0,onCancel:()=>console.log("run")},children:[(0,n.jsxs)(v.A.Group,{children:[(0,n.jsx)(p.Z,{width:"md",name:"name_"+(null==b?void 0:b.id),label:"T\xean của team",value:b.name,rules:[{required:!0}]}),(0,n.jsx)(p.Z,{width:"md",name:"created_by",label:"Được tạo bởi",value:null==b?void 0:null===(a=b.created_by)||void 0===a?void 0:a.name,disabled:!0})]}),(0,n.jsxs)(v.A.Group,{children:[(0,n.jsx)(h.Z,{options:null==j?void 0:j.map(e=>({value:e.id,label:e.name})),width:"md",placeholder:"...",name:"manager_id",label:"Chọn Manager",initialValue:null==b?void 0:null===(t=b.manager)||void 0===t?void 0:t.id,rules:[{required:!0}]}),(0,n.jsx)(h.Z,{options:null==w?void 0:w.map(e=>({value:e.id,label:e.name})),width:"md",placeholder:"...",name:"supervisor_id",label:"Chọn Supervisor",initialValue:null==b?void 0:null===(o=b.supervisor)||void 0===o?void 0:o.id,rules:[{required:!0}]})]})]}),(0,n.jsx)(c.Z,{title:"Bạn c\xf3 chắc chắn muốn x\xf3a team '".concat(E,"'?"),open:q,onOk:handleDeleteTeam,onCancel:()=>{z(!1),N("")},okText:"X\xe1c nhận",cancelText:"Hủy"})]})}t(83343)}}]);